# üìå TicketBookingApi

[![.NET](https://img.shields.io/badge/.NET_9.0-purple?style=for-the-badge&logo=.net)](https://dotnet.microsoft.com/en-us/download/dotnet/9.0)
[![MS_SQL Server](https://img.shields.io/badge/MS_SQL_Server-2022-orange?style=for-the-badge&)](https://www.microsoft.com/en-us/sql-server/sql-server-downloads)
[![Docker](https://img.shields.io/badge/Docker-2CA5E0?style=for-the-badge&logo=docker&logoColor=white)](https://www.docker.com/get-started)
[![Docker Compose](https://img.shields.io/badge/Docker%20Compose-2496ED?style=for-the-badge&logo=docker&logoColor=white)](https://docs.docker.com/compose/install/)

RESTful API –¥–ª—è —Å–∏—Å—Ç–µ–º—ã –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –±–∏–ª–µ—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ ASP.NET Core 9. –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–µ–∑–¥–∫–∞–º–∏, –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –±–∏–ª–µ—Ç–æ–≤ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º–∏ –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

---

## üåü –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è 
    - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –≤—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ (JWT Access/Refresh Tokens)
    - OAuth 2.0 (–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Google, Yandex)

- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∏–ª–µ—Ç–∞–º–∏ 
    - –ü–æ–∫—É–ø–∫–∞ –±–∏–ª–µ—Ç–∞
    - –û—Ç–º–µ–Ω–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
    - –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–≤–æ–∏—Ö –±–∏–ª–µ—Ç–æ–≤
    - –ü—Ä–æ—Å–º–æ—Ç—Ä –±–∏–ª–µ—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤)

- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–µ–∑–¥–∫–∞–º–∏ 
    - –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–µ–∑–¥–∫–∏ (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)
    - –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–µ–∑–¥–∫–∏ (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)
    - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–µ–∑–¥–∫–∏ (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)
    - –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–æ–µ–∑–¥–∫–∏ –ø–æ ID
    - –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –ø–æ–µ–∑–¥–æ–∫ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π

- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ 
    - –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)
    - –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ –∏–º–µ–Ω–∏ (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)
    - –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)
    - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–≤–æ–µ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏  
| –ö–∞—Ç–µ–≥–æ—Ä–∏—è                 | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è                                                                          |
|---------------------------|-------------------------------------------------------------------------------------|
| **Backend**               | ASP.NET Core 9                                                                      |
| **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**           | MS SQL Server                                                                       |
| **ORM**                   | EF Core (Code First)                                                                |
| **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**          | ASP.NET Identity, JWT (Access Tokens + Refresh Tokens), OAuth 2.0 (Google, Yandex)  |
| **–ü–∞—Ç—Ç–µ—Ä–Ω—ã –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏** | CQRS (MediatR), AutoMapper, FluentValidation                                        |
| **API Docs**              | OpenAPI / Swagger, Scalar                                                           |

## ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞
### üñ•Ô∏è –ë–∞–∑–æ–≤—ã–π –∑–∞–ø—É—Å–∫:
–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- .NET 9 SDK
- MS SQL Server (–ª–æ–∫–∞–ª—å–Ω—ã–π –∏–ª–∏ –æ–±–ª–∞—á–Ω—ã–π)

#### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
``` bash
git clone https://github.com/Fl1ckerxD/TicketBookingApi.git
cd TicketBookingApi
```

#### 2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î:
- –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `appsettings.json`
- –ò–∑–º–µ–Ω–∏—Ç–µ —Å—Ç—Ä–æ–∫—É –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:
``` json
"ConnectionStrings": {
    "DefaultConnection": "Server=localhost;Database=TicketBooking;Trusted_Connection=True;TrustServerCertificate=True;"
  }
```

#### 3. –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏:
``` bash
dotnet ef database update
```

#### 4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ OAuth (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
- –î–ª—è Google OAuth:
``` bash
dotnet user-secrets set "Authentication:Google:ClientId" "<CLIENT_ID>"
dotnet user-secrets set "Authentication:Google:ClientSecret" "<CLIENT_SECRET>"
```
- –î–ª—è Yandex OAuth:
``` bash
dotnet user-secrets set "Authentication:Yandex:ClientId" "<CLIENT_ID>"
dotnet user-secrets set "Authentication:Yandex:ClientSecret" "<CLIENT_SECRET>"
```

#### 5. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
``` bash
dotnet run
```
---
### üêã –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ Docker
–î–ª—è —É–¥–æ–±–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ä–µ–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Docker. –ü—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è `Dockerfile` –∏ `docker-compose.yml` –¥–ª—è –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏ —Å–µ—Ä–≤–∏—Å–æ–≤.

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–∞ –≤–∞—à–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã:
- [Docker](https://www.docker.com/get-started)
- [Docker Compose](https://docs.docker.com/compose/install/)

#### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
``` bash
git clone https://github.com/Fl1ckerxD/TicketBookingApi.git
cd TicketBookingApi
```

#### 2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î:
- –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `Program.cs`
- –ò–∑–º–µ–Ω–∏—Ç–µ —Å—Ç—Ä–æ–∫—É –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è c `DefaultConnection` –Ω–∞ `DockerConnection`:
``` c#
const string CONNECTION_STRING = "DockerConnection";
```

#### 3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ OAuth (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
- –°–æ–∑–¥–∞—Ç–µ .env —Ñ–∞–π–ª –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ (—Ä—è–¥–æ–º —Å `docker-compose.yml`)
- –î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è:
```
GOOGLE_CLIENT_ID=<CLIENT_ID>
GOOGLE_CLIENT_SECRET=<CLIENT_SECRET>
YANDEX_CLIENT_ID=<CLIENT_ID>
YANDEX_CLIENT_SECRET=<CLIENT_SECRET>
```

#### 4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é Docker Compose:
``` bash
docker compose up --build
```
---
–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é API –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É:
üëâ http://localhost:5287 –∏–ª–∏ https://localhost:7298

### üë§ –¢–µ—Å—Ç–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ 
–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –≤ —Å–∏—Å—Ç–µ–º–µ —Å–æ–∑–¥–∞—é—Ç—Å—è –¥–≤–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: 
- –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä: 
    - –õ–æ–≥–∏–Ω: log1
    - –ü–∞—Ä–æ–ª—å: admin123
            
- –û–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:
    - –õ–æ–≥–∏–Ω: log2
    - –ü–∞—Ä–æ–ª—å: user123

### üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API:
- Swagger UI: http://localhost:5287/swagger
- Scalar UI: http://localhost:5287/scalar

## üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
### –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤
#### 1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è:
``` http
POST /api/auth/register
Content-Type: application/json

{
    "username": "log3",
    "password": "user123",
    "name": "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä",
    "lastName": "–í–∞—Å–∏–ª—å–µ–≤",
    "patronymic": "–û–ª–µ–≥–æ–≤–∏—á", // –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ
    "email": "brawn@gmail.com", // –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ
    "phoneNumber": "+78800353535" // –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ
}
```

#### 2. –í—Ö–æ–¥:
``` http
POST /api/auth/login
Content-Type: application/json

{
    "username": "log3",
    "password": "user123"
}
```

#### 3. –í—Ö–æ–¥ —á–µ—Ä–µ–∑ —Å—Ç–æ—Ä–æ–Ω–Ω–∏–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã:
- –í—Ö–æ–¥ —á–µ—Ä–µ–∑ Google:
`http://localhost:5287/api/auth/signin/Google`
- –í—Ö–æ–¥ —á–µ—Ä–µ–∑ Yandex:
`http://localhost:5287/api/auth/signin/Yandex`

#### 4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞:
``` http
POST /api/auth/refresh-token
Content-Type: application/json

{
  "token": "<refresh_token>"
}
```

## üì° –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API
### –ü–æ–∫—É–ø–∫–∞ –±–∏–ª–µ—Ç–∞ (—Ç—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è):
``` http
POST /api/tickets
Authorization: Bearer <access_token>
Content-Type: application/json

{
  "tripId": 2,
  "seatNumber": 1
}
```

## üì¨ –°–≤—è–∑—å
–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è, –Ω–∞–ø–∏—à–∏—Ç–µ –º–Ω–µ:
- Email: mihaylov.slava@outlook.com
- Telegram: @Fl1cker_0